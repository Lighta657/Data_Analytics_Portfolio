---
title: "R Notebook"
output: html_notebook
---
```{r}
library(tidyverse)
library(lattice)
library(caret)
set.seed(2241)
```
```{r}
CompleteResponses <- read_csv("C:/Users/Lighta/Desktop/Data_Analytics/Course3/Task2/CompleteResponses.csv")

```
```{r}
#EDA
summary(CompleteResponses)
cor(CompleteResponses1)

```
```{r}
ggplot(CompleteResponses, aes(x = age, y = salary, colour = brand)) +
geom_point(alpha=0.5)+scale_colour_manual(name="Brand", values=c("blue", "green"), labels=c("Acer","Sony"))+labs(title="Frequency Distribution in Salary by Age by Brand group ", x="Age", y="Salary, US$")+theme(plot.title = element_text(hjust = 0.5))
```
```{r}
#Training/testing sets
inTraining<-createDataPartition(CompleteResponses$brand,p=.75,list=FALSE)
training<-CompleteResponses[inTraining, ]
testing<-CompleteResponses[-inTraining, ]
```
```{r}
#C5.0 Automatic grid
fitControl<-trainControl(method="repeatedcv", number=10, repeats=1)
CFiveFit1<-train(brand~.,data=training,method="C5.0",trControl=fitControl,tuneLength=2)
CFiveFit1
```
```{r}
plot(varImp(CFiveFit1),top=5)
```
```{r}
#C5.0 Random search
fitControlRS<-trainControl(method="repeatedcv", number=10, repeats=1,search="random")
CFiveFitRS<-train(brand~.,data=training,method="C5.0",trControl=fitControlRS)
CFiveFitRS
```
```{r}
plot(varImp(CFiveFitRS),top=5)
```
```{r}
#C5.0 manual grid
CFGrid<-expand.grid(trials=10,model="rules",winnow=FALSE)
system.time(CFFit<-train(brand~.,data=training,method="C5.0",trControl=fitControl,tuneGrid=CFGrid))
CFFit
```
```{r}
plot(varImp(CFFit),top=5)
```
```{r}
RFGrid<-expand.grid(mtry=c(1,2,3,4,5))
fitControl<-trainControl(method="repeatedcv", number=10, repeats=1)
system.time(RFFit<-train(brand~.,data=training,method="rf",trControl=fitControl,tuneGrid=RFGrid))
#getModelInfo("rf")
RFFit
```
```{r}
plot(varImp(RFFit),top=5)
```
```{r}
#Testing
preds<-predict(CFiveFit1,testing)
summary(preds)
```
```{r}
#Unseen data - incomplete data
SurveyIncomplete <- read_csv("C:/Users/Lighta/Desktop/Data_Analytics/Course3/Task2/SurveyIncomplete.csv")
```
```{r}
summary(SurveyIncomplete)
```
```{r}
#Predict using unseen data
preds1<-predict(CFiveFit1,SurveyIncomplete, type="raw")
```

```{r}
summary(preds1)
```
```{r}
#Savings preds as .csv
write.csv(preds1,file="C:\\Users\\Lighta\\Desktop\\Data_Analytics\\Course3\\Task2\\C3T2\\predictions.csv")
```

This is an [R Markdown](http://rmarkdown.rstudio.com) Notebook. When you execute code within the notebook, the results appear beneath the code. 

Try executing this chunk by clicking the *Run* button within the chunk or by placing your cursor inside it and pressing *Ctrl+Shift+Enter*. 

```{r}
plot(cars)
```

Add a new chunk by clicking the *Insert Chunk* button on the toolbar or by pressing *Ctrl+Alt+I*.

When you save the notebook, an HTML file containing the code and output will be saved alongside it (click the *Preview* button or press *Ctrl+Shift+K* to preview the HTML file).

The preview shows you a rendered HTML copy of the contents of the editor. Consequently, unlike *Knit*, *Preview* does not run any R code chunks. Instead, the output of the chunk when it was last run in the editor is displayed.
